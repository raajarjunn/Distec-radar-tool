{% load static perm_tags %}

<style>
  /* ---------- easy knobs ---------- */
  #sidenav-main{
    --brand-offset:28px;     /* drop the SAFRAN TECH text a bit */
    --nav-offset:18px;       /* space before the first menu item */
    --sidenav-bg:#0b0b0b;    /* sidebar background */
    --link-color:#cfd3da;    /* normal link */
    --link-hover:#ffffff;    /* hover link */
    --active-bg:#ffffff;     /* active chip bg */
    --active-color:#000000;  /* active chip fg */
  }

  /* layout & background */
  #sidenav-main.navbar{ background:var(--sidenav-bg)!important; }
  #sidenav-main .scrollbar-inner{
    display:flex; flex-direction:column; height:100%;
  }
  #sidenav-main .navbar-inner{
    flex:1 1 auto; overflow-y:auto;   /* menu scrolls */
  }

  /* brand text (top) */
  #sidenav-main .sidenav-header{ padding-top:var(--brand-offset); }
  #sidenav-main .brand-text-only{ display:flex; align-items:center; padding:14px 16px; text-decoration:none; }
  #sidenav-main .brand-text{
    color:#fff; font-family:"Open Sans", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
    font-weight:800; font-size:1.35rem; letter-spacing:.18em; line-height:1; white-space:nowrap;
  }
  #sidenav-main .brand-text .brand-tech{ font-weight:700; letter-spacing:.32em; margin-left:.45em; opacity:.95; }

  /* spacing before menu */
  #sidenav-collapse-main{ margin-top:var(--nav-offset); }

  /* links */
  #sidenav-main .navbar-nav .nav-link{
    display:flex; align-items:center; gap:12px;
    padding:.9rem 1rem; margin:6px 8px; font-size:1.05rem; font-weight:600;
    color:var(--link-color); border-radius:14px;
    transition:background .2s ease,color .2s ease,transform .15s ease;
  }
  #sidenav-main .navbar-nav .nav-link i{ font-size:1.15rem; width:1.6rem; text-align:center; opacity:.9; }
  #sidenav-main .navbar-nav .nav-link:hover{ background:rgba(255,255,255,.10); color:var(--link-hover); transform:translateX(2px); }
  #sidenav-main .navbar-nav .nav-link:hover i{ color:var(--link-hover)!important; }
  #sidenav-main .navbar-nav .nav-link.active{
    background:var(--active-bg)!important; color:var(--active-color)!important; box-shadow:0 8px 22px rgba(0,0,0,.22);
  }
  #sidenav-main .navbar-nav .nav-link.active i,
  #sidenav-main .navbar-nav .nav-link.active .nav-link-text{ color:var(--active-color)!important; }
  #sidenav-main .navbar-nav .nav-link .nav-link-text{ color:inherit!important; }

  /* footer logo (bottom, non-scrolling) */
  #sidenav-main .sidenav-footer{
    flex:0 0 auto; padding:14px 12px 18px;
    border-top:1px solid rgba(255,255,255,.08);
  }
  #sidenav-main .safran-logo{
    display:block; margin:8px auto 6px; width:78%; max-width:180px;
    opacity:.92; filter:drop-shadow(0 2px 6px rgba(0,0,0,.4));
    transition:opacity .2s ease, transform .15s ease;
  }
  #sidenav-main .safran-logo:hover{ opacity:1; transform:scale(1.02); }
  #sidenav-main .sidenav-footer small{
    display:block; text-align:center; color:#99a1b3; letter-spacing:.04em;
  }

  /* compact on short screens */
  @media (max-height:700px){
    #sidenav-main{ --brand-offset:18px; --nav-offset:10px; }
    #sidenav-main .brand-text{ font-size:1.2rem; letter-spacing:.16em; }
    #sidenav-main .brand-text .brand-tech{ letter-spacing:.28em; }
  }
</style>

<nav class="sidenav navbar navbar-vertical fixed-left navbar-expand-xs navbar-light bg-darker" id="sidenav-main">
  <div class="scrollbar-inner">

    <!-- Brand (text at top) -->
    <div class="sidenav-header align-items-center">
      <a class="navbar-brand brand-text-only" href="/" aria-label="Safran Tech">
        <span class="brand-text">SAFRAN <span class="brand-tech">TECH</span></span>
      </a>
    </div>

    <!-- Menu -->
    <div class="navbar-inner">
      <div class="collapse navbar-collapse" id="sidenav-collapse-main">

        {% url 'mindmap' as mindmap_url %}
        {% url 'role_admin_list' as role_admin_url %}

        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link{% if 'index' in segment %} active{% endif %}" href="/">
              <i class="ni ni-tv-2"></i><span class="nav-link-text">Dashboard</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link{% if segment == 'technology' %} active{% endif %}" href="{% url 'technology_list' %}">
              <i class="ni ni-planet"></i><span class="nav-link-text">Technology</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link{% if request.path == mindmap_url %} active{% endif %}"
              href="{{ mindmap_url }}"
              target="_blank"
              rel="noopener noreferrer">
              <i class="ni ni-collection"></i>
              <span class="nav-link-text">Mind Map</span>
            </a>
          </li>

          {% if user.is_authenticated and user|can:"manage_roles" %}
          <li class="nav-item">
            <a class="nav-link{% if request.path == role_admin_url %} active{% endif %}" href="{{ role_admin_url }}">
              <i class="ni ni-settings"></i><span class="nav-link-text">Role Admin</span>
            </a>
          </li>
          {% endif %}
        </ul>

      </div>
    </div>

    <!-- Footer (logo at bottom) -->
    <div class="sidenav-footer">
      <a href="/" aria-label="Safran home">
        <img class="safran-logo" src="{% static 'assets/img/brand/LOGO_SAFRAN_reserve_rvb.png' %}" alt="SAFRAN logo">
      </a>
      <small>&copy; {{ now|default:None|date:"Y" }} SAFRAN</small>
    </div>

  </div>
</nav>
